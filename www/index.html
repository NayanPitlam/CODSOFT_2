<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QuoteAajkal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap');
        .quote-text {
            /* Text size adjustment for mobile screens */
            font-size: 1.5rem; /* 24px */
            line-height: 1.8;
            font-weight: 500;
        }
        @media (min-width: 640px) {
            .quote-text {
                font-size: 1.875rem; /* 30px */
            }
        }
    </style>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
</head>
<body class="bg-gray-50 min-h-screen p-4 sm:p-8 font-sans text-gray-900 flex flex-col items-center">

    <div id="app" class="w-full max-w-xl mx-auto flex flex-col">
        <h1 class="text-3xl font-extrabold text-center text-emerald-600 mb-8 mt-4">
            QuoteAajkal
        </h1>

        <!-- Navigation/View Toggle -->
        <div class="flex space-x-4 mb-8 bg-white p-2 rounded-xl shadow-lg border border-gray-100">
            <button id="view-home-btn" onclick="setView('home')" class="flex-1 py-2 px-4 rounded-lg font-semibold transition duration-300 text-white bg-emerald-500 shadow-md hover:bg-emerald-600">
                <i data-lucide="sun" class="w-5 h-5 inline mr-2"></i> Today's Quote
            </button>
            <button id="view-favorites-btn" onclick="setView('favorites')" class="flex-1 py-2 px-4 rounded-lg font-semibold transition duration-300 text-gray-600 hover:bg-gray-100">
                <i data-lucide="heart" class="w-5 h-5 inline mr-2"></i> Favorites (<span id="fav-count">0</span>)
            </button>
        </div>
        
        <!-- --- HOME VIEW: Quote Display --- -->
        <div id="home-view" class="view-container">
            <div id="quote-card" class="bg-white p-8 rounded-2xl shadow-2xl border-t-8 border-emerald-400 transition-all duration-500">
                <blockquote class="text-center">
                    <p id="current-quote" class="quote-text italic text-gray-800 mb-6"></p>
                    <footer class="text-lg font-semibold text-emerald-600">
                        — <cite id="current-author" class="not-italic"></cite>
                    </footer>
                </blockquote>
            </div>

            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mt-8">
                <button id="favorite-btn" onclick="toggleFavorite()" class="p-3 bg-white border border-gray-300 text-red-500 rounded-full shadow-md hover:shadow-lg transition duration-300" title="Favorite">
                    <i data-lucide="heart" class="w-6 h-6"></i>
                </button>
                <button id="share-btn" onclick="shareQuote()" class="p-3 bg-emerald-500 text-white rounded-full shadow-md hover:bg-emerald-600 hover:shadow-lg transition duration-300" title="Share Quote">
                    <i data-lucide="share-2" class="w-6 h-6"></i>
                </button>
                <button id="refresh-btn" onclick="forceNewQuote()" class="p-3 bg-gray-200 text-gray-600 rounded-full shadow-md hover:bg-gray-300 hover:shadow-lg transition duration-300" title="Next Quote">
                    <i data-lucide="rotate-cw" class="w-6 h-6"></i>
                </button>
            </div>
            <p id="refresh-message" class="text-center text-sm text-gray-500 mt-4"></p>
        </div>

        <!-- --- FAVORITES VIEW: Saved Quotes List --- -->
        <div id="favorites-view" class="view-container hidden">
            <div id="favorites-list" class="space-y-4">
                <!-- Favorite quotes will be rendered here -->
            </div>
            <div id="no-favorites-message" class="text-center p-12 bg-white rounded-xl text-gray-500 shadow-inner mt-4">
                <i data-lucide="inbox" class="w-10 h-10 mx-auto mb-3"></i>
                <p class="font-semibold">You haven't saved any favorites yet!</p>
                <p class="text-sm mt-1">Tap the heart icon on the daily quote to save it.</p>
            </div>
        </div>
    </div>

    <!-- Toast/Alert for copying -->
    <div id="toast" class="hidden fixed bottom-6 left-1/2 transform -translate-x-1/2 px-5 py-3 bg-gray-800 text-white text-sm rounded-lg shadow-xl z-50 transition-opacity duration-300">
        Quote copied to clipboard!
    </div>

    <script>
        // --- Data ---
        const QUOTES = [
            { quote: "The only way to do great work is to love what you do.", author: "Steve Jobs" },
            { quote: "Strive not to be a success, but rather to be of value.", author: "Albert Einstein" },
            { quote: "The future belongs to those who believe in the beauty of their dreams.", author: "Eleanor Roosevelt" },
            { quote: "The mind is everything. What you think you become.", author: "Buddha" },
            { quote: "The best time to plant a tree was 20 years ago. The second best time is now.", author: "Chinese Proverb" },
            { quote: "If you want to lift yourself up, lift up someone else.", author: "Booker T. Washington" },
            { quote: "The journey of a thousand miles begins with a single step.", author: "Lao Tzu" },
            { quote: "Our greatest glory is not in never failing, but in rising up every time we fail.", author: "Ralph Waldo Emerson" },
            { quote: "It is never too late to be what you might have been.", author: "George Eliot" },
        ];

        // --- State Variables ---
        let currentQuoteIndex = null;
        let currentQuote = {};
        let favorites = JSON.parse(localStorage.getItem('favoriteQuotes')) || [];
        let currentView = 'home';
        
        // --- DOM Elements ---
        const homeView = document.getElementById('home-view');
        const favoritesView = document.getElementById('favorites-view');
        const currentQuoteEl = document.getElementById('current-quote');
        const currentAuthorEl = document.getElementById('current-author');
        const favoriteBtn = document.getElementById('favorite-btn');
        const favCountEl = document.getElementById('fav-count');
        const favoritesListEl = document.getElementById('favorites-list');
        const noFavoritesMessageEl = document.getElementById('no-favorites-message');
        const toastEl = document.getElementById('toast');
        const refreshMessageEl = document.getElementById('refresh-message');
        const viewHomeBtn = document.getElementById('view-home-btn');
        const viewFavoritesBtn = document.getElementById('view-favorites-btn');

        // --- Utility Functions ---

        const getTodayDateString = () => new Date().toISOString().slice(0, 10);
        
        // Copy text to clipboard (using deprecated execCommand for broader compatibility, especially in embedded webviews/iframes)
        const copyToClipboard = (text) => {
            const textarea = document.createElement('textarea');
            textarea.value = text;
            textarea.style.position = 'fixed'; // Prevents scrolling to bottom
            document.body.appendChild(textarea);
            textarea.focus();
            textarea.select();
            try {
                document.execCommand('copy');
                showToast();
            } catch (err) {
                console.error('Could not copy text: ', err);
            }
            document.body.removeChild(textarea);
        };

        const showToast = () => {
            toastEl.classList.remove('hidden', 'opacity-0');
            toastEl.classList.add('opacity-100');
            setTimeout(() => {
                toastEl.classList.remove('opacity-100');
                toastEl.classList.add('opacity-0');
                // Hide after transition
                setTimeout(() => toastEl.classList.add('hidden'), 300); 
            }, 2000);
        };
        
        // --- Quote Logic ---

        const selectNewQuote = (force = false) => {
            const today = getTodayDateString();
            const lastRefreshDate = localStorage.getItem('lastRefreshDate');
            let savedIndex = localStorage.getItem('dailyQuoteIndex');
            
            // Check if it's a new day OR if we are forcing a refresh
            if (force || lastRefreshDate !== today) {
                let newIndex;
                do {
                    newIndex = Math.floor(Math.random() * QUOTES.length);
                } while (newIndex === parseInt(savedIndex)); // Avoid repeating the last quote immediately

                currentQuoteIndex = newIndex;
                currentQuote = QUOTES[currentQuoteIndex];
                
                localStorage.setItem('dailyQuoteIndex', currentQuoteIndex);
                localStorage.setItem('lastRefreshDate', today);
                refreshMessageEl.textContent = "Quote updated for a new day.";

            } else {
                // If it's the same day, load the saved quote
                currentQuoteIndex = parseInt(savedIndex);
                currentQuote = QUOTES[currentQuoteIndex];
                refreshMessageEl.textContent = `Today's quote (Updated ${lastRefreshDate})`;
            }
            
            renderQuote();
        };

        const forceNewQuote = () => {
            selectNewQuote(true);
        };

        const renderQuote = () => {
            currentQuoteEl.textContent = currentQuote.quote;
            currentAuthorEl.textContent = currentQuote.author;
            updateFavoriteButton();
        };

        const updateFavoriteButton = () => {
            const isFavorite = isQuoteFavorite(currentQuote.quote);
            favoriteBtn.classList.toggle('bg-red-500', isFavorite);
            favoriteBtn.classList.toggle('text-white', isFavorite);
            favoriteBtn.classList.toggle('bg-white', !isFavorite);
            favoriteBtn.classList.toggle('text-red-500', !isFavorite);
            
            favoriteBtn.innerHTML = `<i data-lucide="heart" class="w-6 h-6 fill-current"></i>`;
            lucide.createIcons();
        };

        // --- Favorite Management ---

        const isQuoteFavorite = (quoteText) => {
            return favorites.some(fav => fav.quote === quoteText);
        };

        const toggleFavorite = () => {
            const isFav = isQuoteFavorite(currentQuote.quote);
            
            if (isFav) {
                // Remove favorite
                favorites = favorites.filter(fav => fav.quote !== currentQuote.quote);
            } else {
                // Add favorite
                favorites.push(currentQuote);
            }
            
            localStorage.setItem('favoriteQuotes', JSON.stringify(favorites));
            updateFavoriteButton();
            renderFavoritesList();
            showToastMessage(isFav ? "Removed from Favorites." : "Added to Favorites!");
        };

        const deleteFavorite = (quoteText) => {
            favorites = favorites.filter(fav => fav.quote !== quoteText);
            localStorage.setItem('favoriteQuotes', JSON.stringify(favorites));
            renderFavoritesList();
            updateFavoriteButton(); // Update if the deleted quote was the current one
            showToastMessage("Favorite quote deleted.");
        };

        const renderFavoritesList = () => {
            favoritesListEl.innerHTML = '';
            favCountEl.textContent = favorites.length;

            if (favorites.length === 0) {
                noFavoritesMessageEl.classList.remove('hidden');
            } else {
                noFavoritesMessageEl.classList.add('hidden');
                favorites.forEach(fav => {
                    const item = document.createElement('div');
                    item.className = 'bg-white p-6 rounded-xl shadow-md border-l-4 border-red-300';
                    item.innerHTML = `
                        <p class="italic text-gray-700 mb-3">${fav.quote}</p>
                        <div class="flex justify-between items-center">
                            <footer class="text-sm font-semibold text-gray-500">— ${fav.author}</footer>
                            <button onclick="deleteFavorite('${fav.quote.replace(/'/g, "\\'")}')" class="p-2 text-red-600 hover:bg-red-50 rounded-full transition duration-150" title="Delete">
                                <i data-lucide="trash-2" class="w-5 h-5"></i>
                            </button>
                        </div>
                    `;
                    favoritesListEl.appendChild(item);
                });
            }
            lucide.createIcons();
        };

        // --- Sharing ---

        const shareQuote = () => {
            const textToShare = `"${currentQuote.quote}" — ${currentQuote.author} #QuoteOfTheDay`;
            
            // In a native app (via Capacitor), this would trigger the system share sheet.
            // In the browser, we copy the text to the clipboard.
            copyToClipboard(textToShare);
        };
        
        const showToastMessage = (message) => {
            toastEl.textContent = message;
            showToast();
        };

        // --- View Management ---

        const setView = (view) => {
            currentView = view;
            
            // Reset button styles
            viewHomeBtn.className = "flex-1 py-2 px-4 rounded-lg font-semibold transition duration-300 text-gray-600 hover:bg-gray-100";
            viewFavoritesBtn.className = "flex-1 py-2 px-4 rounded-lg font-semibold transition duration-300 text-gray-600 hover:bg-gray-100";
            
            homeView.classList.add('hidden');
            favoritesView.classList.add('hidden');

            if (view === 'home') {
                homeView.classList.remove('hidden');
                viewHomeBtn.classList.remove('text-gray-600', 'hover:bg-gray-100');
                viewHomeBtn.classList.add('text-white', 'bg-emerald-500', 'shadow-md', 'hover:bg-emerald-600');
            } else if (view === 'favorites') {
                favoritesView.classList.remove('hidden');
                viewFavoritesBtn.classList.remove('text-gray-600', 'hover:bg-gray-100');
                viewFavoritesBtn.classList.add('text-white', 'bg-emerald-500', 'shadow-md', 'hover:bg-emerald-600');
                renderFavoritesList();
            }
            lucide.createIcons();
        };
        
        // --- Initialization ---

        const init = () => {
            selectNewQuote();
            renderFavoritesList();
            setView('home'); // Ensure home is the initial view
        };

        window.onload = init;
    </script>
</body>
</html>
